var SunX={};window.SunX=SunX,SunX.SEvent={RES_LOAD_OVER:9e9,RewardedVideoOver:9000000001},SunX._isGC=!1,SunX.GC=function(){SunX._isGC=!0},SunX._destroySceneName=null,SunX.DestroyScene=function(e){SunX._destroySceneName=e,SunX._isGC=!0},SunX._SEventEntry=cc.Class({ctor:function(){this.tag=0,this.target=null,this.func=null,this.isDirty=!1},InitData:function(e,t,s){this.tag=e,this.target=s,this.func=t},Execute:function(e){this.func.call(this.target,e)}}),SunX.sEventManager=null,SunX.ClassEventID=1,SunX.__getClassEventID=function(){return SunX.ClassEventID++},SunX._SEventManager=cc.Class({ctor:function(){this._hashForEntry={},this._hashListener={},this._removeArray=[],this._isRemoveDirty=!1,cc.director.getScheduler().enableForTarget(this),cc.director.getScheduler().schedule(this._update,this,0,cc.macro.REPEAT_FOREVER,0,!1)},ExecuteEvent:function(e,t){var s=this._hashListener[e];if(s)for(var i=s.length,n=null,a=0;a<i;++a)(n=s[a]).isDirty||n.Execute({tag:e,data:t})},AddEvent:function(e,t,s){var i=this._getTargetId(s),n=this._hashForEntry[i];n||(n=[],this._hashForEntry[i]=n);var a=this._findTagToEntry(n,e);a?a.isDirty&&(a.isDirty=!1,cc.js.array.remove(this._removeArray,a)):(a=this._addListenerMap(e,t,s),n.push(a))},RemoveEvent:function(e,t){var s=this._getTargetId(t),i=this._hashForEntry[s];if(i){var n=this._findTagToEntry(i,e);n&&!n.isDirty&&(n.isDirty=!0,this._removeArray.push(n),this._isRemoveDirty=!0)}},RemoveAllEvent:function(e){var t=this._getTargetId(e),s=this._hashForEntry[t];if(s){var i=s.length;if(0!=i){for(var n=null,a=0;a<i;++a)(n=s[a]).isDirty||(n.isDirty=!0,this._removeArray.push(n));this._isRemoveDirty=!0}}},_update:function(e){if(this._isRemoveDirty){for(var t=0,s=null,i=null,n=null,a=0,r=this._removeArray.length;--r>=0;)if(i=this._removeArray[r],n=this._hashListener[i.tag]){if(t=this._getTargetId(i.target),!(s=this._hashForEntry[t]))continue;a=s.length,this._arrRemoveItem(s,i,a),this._arrRemoveItem(n,i,n.length),1==a&&delete this._hashForEntry[t]}this._removeArray.length=0,this._isRemoveDirty=!1}},_addListenerMap:function(e,t,s){var i=this._hashListener[e];i||(i=[],this._hashListener[e]=i);var n=new SunX._SEventEntry;return n.InitData(e,t,s),i.push(n),n},_findTargetToEntry:function(e,t){for(var s=e.length,i=0;i<s;++i)if(t==e[i].target)return e[i];return null},_findTagToEntry:function(e,t){for(var s=e.length,i=0;i<s;++i)if(t==e[i].tag)return e[i];return null},_arrRemoveItem:function(e,t,s){if(1==s)e.pop();else{var i=e.indexOf(t);if(-1==i)return;s-1==i?e.pop():e[i]=e.pop()}},_getTargetId:function(e){return e.__sunxeventID?e.__sunxeventID:(e.__sunxeventID=SunX.__getClassEventID(),e.__sunxeventID)}}),SunX._SResItem=cc.Class({ctor:function(){this._uuid=null,this._loadUrl=null,this._fullPath=null,this._type=null,this._spriteFrameName="",this._sceneData=[],this._callFunc=null,this.LoadingType=0},Init:function(e,t,s,i){this._uuid=e,this._loadUrl=t,this._fullPath=s,this._type=i,this._spriteFrameName="",this._sceneData=[],this._callFunc=null,this.LoadingType=0},GetUUID:function(){return this._uuid},GetLoadUrl:function(){return this._loadUrl},GetFullPath:function(){return this._fullPath},GetType:function(){return this._type},GetResID:function(){return this._loadUrl}}),SunX._SResManager=cc.Class({ctor:function(){this._pathItemHash={},this._uuidItemHash={},this._sceneHash={},this._spriteFrameCache={},this._totalNum=-1,this._count=-1,this._cacheRes={},this._cacheSceneRes={},this._curScene=null},_initRes:function(){var e=void 0;window&&(e=window._CCSettings),e||(e=_CCSettings);var t=e.rawAssets;t&&this._parseResData(t);var s=e.scenes;s&&this._parseSceneData(s),window&&(window._CCSettings=void 0),_CCSettings=void 0},_parseSceneData:function(e){for(var t=e.length,s=null,i=null,n=-1,a=-1,r=0;r<t;++r)n=(i=(s=e[r]).url).lastIndexOf("/"),a=i.lastIndexOf(".fire"),this._sceneHash[s.uuid]=i.slice(n+1,a)},_parseResData:function(e){e=e.assets;var t,s,i,n,a,r,c;for(var h in e)a=(t=e[h])[0],i=t[1],(n=cc.js._getClassById(i))?(s=a,r=cc.js.isChildClassOf(n,cc.Asset)?h:cc.url.raw(a),(c=new SunX._SResItem).Init(h,r,a,n),this._pathItemHash[s]=c,this._uuidItemHash[h]=c):cc.error("Cannot get",i)},GetSpriteFrame:function(e){return this._spriteFrameCache[e]},GetRes:function(e){var t=this._pathItemHash[e];if(!t)return this.Load(e),null;var s=cc.loader._getReferenceKey(t.GetLoadUrl());return cc.loader.getRes(s)},GetResDir:function(e){return cc.loader._assetTables.assets.getUuidArray(e,null)},ReleaseRes:function(e){var t,s;e instanceof Array||(e=e?[e]:[]);for(var i=0;i<e.length;++i)t=e[i],(s=this._pathItemHash[t])&&(1!=s.LoadingType?this._releaseOne(s):s.LoadingType=0)},ReleaseSceneRes:function(e){if(void 0==e)for(var t in this._cacheSceneRes)this._subCacheResArray(this._cacheSceneRes[t]),delete this._cacheSceneRes[t];else{var s=this._cacheSceneRes[e];if(delete this._cacheSceneRes[e],!s)return;this._subCacheResArray(s)}this.PurgeCachedRes()},PurgeCachedRes:function(){for(var e in this._cacheRes)0==this._cacheRes[e]&&(cc.loader.release(e),delete this._cacheRes[e])},Load:function(e){e instanceof Array||(e=e?[e]:[]);var t=e.length;if(0!=t){for(var s,i,n=0;n<t;)"string"==typeof(s=e[n])?(i=this._pathItemHash[s])||(i=this._uuidItemHash[s]):((i=this._pathItemHash[s.url])||(i=this._uuidItemHash[s.url]),i._callFunc=s.func),i?(i.LoadingType=1,cc.js.isChildClassOf(i._type,cc.Asset)?e[n]={type:"uuid",uuid:i._loadUrl}:e[n]=i._loadUrl,n++):(e.splice(n,1),t=e.length);-1==this._count&&(this._count=0),-1==this._totalNum?this._totalNum=e.length:this._totalNum+=e.length;var a=this;cc.loader.load(e,function(e,t){var s,i,n=t.map;for(var r in n)i=n[r],(s=t.getContent(r))&&(cc.loader.setAutoReleaseRecursively(r,!1),a._loadOver(e,r,i.url,s,i.dependKeys))})}},_loadOver:function(e,t,s,i,n){var a=this._uuidItemHash[t];if(a||(a=this._uuidItemHash[i._uuid]),!a){var r=t.indexOf("resources");if(r>=0){var c=t.slice(r+10);a=this._pathItemHash[c]}}if(a){if(0==a.LoadingType)return h=cc.loader.getDependsRecursively(i),cc.loader.release(h),a._callFunc=null,void this._loadCount();var h;a.LoadingType=2,a.GetType()==cc.SpriteFrame?(this._spriteFrameCache[i.name]=i,a._spriteFrameName=i.name,this._addCacheRes(s),this._addCacheResArray(n)):a.GetType()==cc.SpriteAtlas?(h=cc.loader.getDependsRecursively(i),this._addCacheResArray(h),this._loadSpriteAtlas(i)):a.GetType()==cc.SceneAsset?(h=cc.loader.getDependsRecursively(i),Array.prototype.push.apply(a._sceneData,h),this._cacheSceneRes[i.name]&&delete this._cacheSceneRes[i.name],this._addCacheResArray(h)):a.GetType()==cc.AudioClip?(this._totalNum+=1,this._addCacheRes(s),cc.audioEngine.preload(s,function(e){SunX.sRes._loadCount()})):(h=cc.loader.getDependsRecursively(t),this._addCacheResArray(h)),a._callFunc&&(a._callFunc(i),a._callFunc=null)}this._loadCount()},_loadCount:function(){this._count+=1,this._totalNum==this._count&&(this._count=-1,this._totalNum=-1,SunX.sEventManager.ExecuteEvent(SunX.SEvent.RES_LOAD_OVER,null))},_loadSpriteAtlas:function(e){var t=e._spriteFrames;for(var s in t)this._spriteFrameCache[s]=t[s]},_releaseOne:function(e){var t,s,i;e&&(e.GetType()==cc.SpriteFrame?(delete this._spriteFrameCache[e._spriteFrameName],s=cc.loader.getDependsRecursively(e.GetLoadUrl()),this._subCacheResArray(s)):e.GetType()==cc.SpriteAtlas?(t=cc.loader._getReferenceKey(e.GetLoadUrl()),(i=cc.loader.getRes(t))&&this._releaseSpriteAtlas(i)):e.GetType()==cc.SceneAsset?this._releaseScene(e):e.GetType()==cc.AudioClip?(this._subCacheRes(e.GetLoadUrl()),cc.audioEngine.uncache(e.GetLoadUrl())):e.GetType()==cc.RawAsset?this._subCacheRes(e.GetLoadUrl()):(t=cc.loader._getReferenceKey(e.GetLoadUrl()),(i=cc.loader.getRes(t))&&this._releaseDepends(i)),e.LoadingType=0)},_releaseSpriteAtlas:function(e){var t=e._spriteFrames;for(var s in t)delete this._spriteFrameCache[s];this._releaseDepends(e)},_releaseDepends:function(e){var t=cc.loader.getDependsRecursively(e);this._subCacheResArray(t)},_releaseScene:function(e){this._subCacheResArray(e._sceneData),e._sceneData.length=0},_onSceneLaunch:function(e){var t=!0,s=this._sceneHash[e._id];if(s||(s=e._name),s&&""!=s){var i=cc.director._getSceneUuid(s);i&&(this._cacheRes[i.uuid]&&(t=!1),this._curScene=e,t&&(this._curScene.autoReleaseAssets||this._cacheSceneRes[this._curScene.name]||(this._addCacheSceneRes(this._curScene),this._addCacheResArray(this._curScene.dependAssets))))}},_addCacheResArray:function(e){for(var t=e.length,s=0;s<t;++s)this._addCacheRes(e[s])},_addCacheRes:function(e){var t=this._cacheRes[e];void 0==t?this._cacheRes[e]=1:(++t,this._cacheRes[e]=t)},_addCacheSceneRes:function(e){var t=[];Array.prototype.push.apply(t,e.dependAssets),this._cacheSceneRes[e.name]=t},_subCacheResArray:function(e){for(var t=e.length,s=0;s<t;++s)this._subCacheRes(e[s])},_subCacheRes:function(e){var t=this._cacheRes[e];void 0!=t&&t>0&&(--t,this._cacheRes[e]=t)}}),SunX.sAudio=null,SunX._SAudio=cc.Class({ctor:function(){this.m_musicNumber=100,this.m_soundNumber=100,this.m_bgName=null,this.m_bgID=null,this.m_audioHash={}},_setMusic:function(e){null!=this.m_bgID&&cc.audioEngine.setVolume(this.m_bgID,e/100)},_setSound:function(e){for(var t in this.m_audioHash)cc.audioEngine.setVolume(this.m_audioHash[t],e/100)},SetMusic:function(e){e!=this.m_musicNumber&&(this.m_musicNumber=e,this._setMusic(e))},SetSound:function(e){e!=this.m_soundNumber&&(this.m_soundNumber=e,this._setSound(e))},PlayMusic:function(e){e&&this.m_bgName!=e.nativeUrl&&(this.m_bgName=e.nativeUrl,null!=this.m_bgID&&cc.audioEngine.stop(this.m_bgID),this.m_bgID=this._playSound(e,!0,this.m_musicNumber))},PlayEffect:function(e,t){if(e)if(void 0===t&&(t=!1),t){if(this.m_audioHash[e.nativeUrl])return;var s=this._playSound(e,!0,this.m_soundNumber);this.m_audioHash[e.nativeUrl]=s}else{if(0==this.m_soundNumber)return;this._playSound(e,!1,this.m_soundNumber)}},StopMusic:function(e){e&&this.m_bgName==e.nativeUrl&&(cc.audioEngine.stop(this.m_bgID),this.m_bgName=null,this.m_bgID=null)},StopEffect:function(e){if(e){var t=this.m_audioHash[e.nativeUrl];t&&(cc.audioEngine.stop(t),delete this.m_audioHash[e.nativeUrl])}},StopAllEffect:function(){for(var e in this.m_audioHash)cc.audioEngine.stop(this.m_audioHash[e],value);this.m_audioHash={}},AppEnterBackground:function(e){this._setMusic(0),this._setSound(0)},AppEnterForeground:function(e){this._setMusic(this.m_musicNumber),this._setSound(this.m_soundNumber)},_playSound:function(e,t,s){return 0==s?s=1e-4:s/=100,cc.audioEngine.play(e,t,s)}}),SunX.sUserData=null,SunX._SUserData=cc.Class({ctor:function(){this.SaveUserData=this._webSave,this.ReadUserData=this._webRead},SetXXTea:function(e){},Write:function(e,t){this.SaveUserData(e,t)},Read:function(e){return this.ReadUserData(e)},FindFile:function(e){return!!cc.sys.localStorage.getItem(e)},_webSave:function(e,t){cc.sys.localStorage.setItem(e,t)},_webRead:function(e){return cc.sys.localStorage.getItem(e)}}),SunX.sUtils={RandomMinToMax:function(e,t){return parseInt(Math.random()*(t-e+1)+e)},ShowMessage:function(e,t,s){var i=new cc.Node;i.addComponent(cc.Label).string=e,i.color=t||cc.Color.WHITE,i.addComponent(cc.LabelOutline).color=s||cc.Color.BLACK,i.opacity=0,i.x=cc.view.getVisibleSize().width/2,i.y=cc.view.getVisibleSize().height/2,i.parent=cc.director.getScene();var n=cc.spawn(cc.moveBy(2,cc.v2(0,100)),cc.sequence(cc.fadeIn(.2),cc.delayTime(1.5),cc.fadeOut(.3)));i.runAction(cc.sequence(n,cc.callFunc(function(){i.parent=null,i.destroy(),i=null})))},Abs:function(e){return e<0?-e:e},OddOrEven:function(e){return!!(1&e)},GetClockToString:function(e){var t="",s=parseInt(e/60),i=parseInt(e-60*s);return t+=s<=9?"0"+s:s,t+=":",t+=i<=9?"0"+i:i},GetClockHourToString:function(e){},IsEmptyObject:function(e){for(var t in e)return!1;return!0},SliceResourcePath:function(e){var t=e,s=t.indexOf("resources/");return-1==s?e:t=t.slice(s+10)},CalCircleCenter:function(e,t,s){var i,n=0,a=0,r=0,c=1,h=1,u=1,o=cc.Vec2.ZERO,l=cc.Vec2.ZERO;return 0==(i=(t.y-e.y)/(t.x-e.x))?(o.x=(e.x+t.x)/2,l.x=(e.x+t.x)/2,o.y=e.y+Math.sqrt(s*s-(e.x-t.x)*(e.x-t.x)/4),l.y=t.y-Math.sqrt(s*s-(e.x-t.x)*(e.x-t.x)/4)):(n=-1/i,a=(e.x+t.x)/2,r=(e.y+t.y)/2,c=1+n*n,h=-2*a-n*n*(e.x+t.x),u=a*a+n*n*(e.x+t.x)*(e.x+t.x)/4-(s*s-((a-e.x)*(a-e.x)+(r-e.y)*(r-e.y))),o.x=(-1*h+Math.sqrt(h*h-4*c*u))/(2*c),l.x=(-1*h-Math.sqrt(h*h-4*c*u))/(2*c),o.y=this._yCoordinates(a,r,n,o.x),l.y=this._yCoordinates(a,r,n,l.x)),[o,l]},_yCoordinates:function(e,t,s,i){return s*i-s*e+t}},SunX.sBezier={p0:cc.Vec2.ZERO,p1:cc.Vec2.ZERO,p2:cc.Vec2.ZERO,step:0,ax:0,ay:0,bx:0,by:0,A:0,B:0,C:0,total_length:0,s:function(e){return Math.sqrt(this.A*e*e+this.B*e+this.C)},L:function(e){var t=Math.sqrt(this.C+e*(this.B+this.A*e)),s=2*this.A*e*t+this.B*(t-Math.sqrt(this.C)),i=Math.log(this.B+2*Math.sqrt(this.A)*Math.sqrt(this.C)),n=Math.log(this.B+2*this.A*e+2*Math.sqrt(this.A)*t);return(2*Math.sqrt(this.A)*s+(this.B*this.B-4*this.A*this.C)*(i-n))/(8*Math.pow(this.A,1.5))},InvertL:function(e,t){for(var s,i=e;;){if(s=i-(this.L(i)-t)/this.s(i),Math.abs(i-s)<1e-6)break;i=s}return s},Init:function(e,t,s,i){return this.p0=e,this.p1=t,this.p2=s,this.ax=this.p0.x-2*this.p1.x+this.p2.x,this.ay=this.p0.y-2*this.p1.y+this.p2.y,this.bx=2*this.p1.x-2*this.p0.x,this.by=2*this.p1.y-2*this.p0.y,this.A=4*(this.ax*this.ax+this.ay*this.ay),this.B=4*(this.ax*this.bx+this.ay*this.by),this.C=this.bx*this.bx+this.by*this.by,this.total_length=this.L(1),this.step=Math.floor(this.total_length/i),this.total_length%i>i/2&&this.step++,this.step},GetAnchorPoint:function(e){if(e>=0&&e<=this.step){var t=e/this.step,s=t*this.total_length,i=(1-(t=this.InvertL(t,s)))*(1-t)*this.p0.x+2*(1-t)*t*this.p1.x+t*t*this.p2.x,n=(1-t)*(1-t)*this.p0.y+2*(1-t)*t*this.p1.y+t*t*this.p2.y,a=cc.v2((1-t)*this.p0.x+t*this.p1.x,(1-t)*this.p0.y+t*this.p1.y),r=cc.v2((1-t)*this.p1.x+t*this.p2.x,(1-t)*this.p1.y+t*this.p2.y),c=r.x-a.x,h=r.y-a.y;return{x:i,y:n,angel:180*Math.atan2(h,c)/Math.PI}}return{}}},SunX.SHandle=cc.Class({statics:{Create:function(e,t){var s=new SunX.SHandle;return s.init(e,t),s}},init:function(e,t){this.handle=e,this.target=t},Execute:function(e){this.handle.call(this.target,e)}}),cc.game.once(cc.game.EVENT_ENGINE_INITED,function(){SunX.sEventManager=new SunX._SEventManager,SunX.sRes=new SunX._SResManager,SunX.sUserData=new SunX._SUserData,SunX.sAudio=new SunX._SAudio,cc.p=cc.v2,cc.director.on(cc.Director.EVENT_AFTER_SCENE_LAUNCH,function(e){SunX.sRes._onSceneLaunch(e)}),cc.director.on(cc.Director.EVENT_AFTER_DRAW,function(e){SunX._destroySceneName&&(SunX.sRes.ReleaseSceneRes(SunX._destroySceneName),SunX._destroySceneName=null),SunX._isGC&&(SunX._isGC=!1,cc.sys.garbageCollect())}),SunX.sRes._initRes()});